!function(){"use strict";function t(t,e=""){let o=0;function n(t){var i;try{t()}catch(t){console.log("error",t),o<5&&setTimeout((()=>n(++o)),3e3),o>5&&(null===(i=window.roam42)||void 0===i||i.help.displayMessage(`${e}加载失败`,2e3))}}setTimeout((()=>n(t)),3e3)}var e,o;new MutationObserver(((t,e)=>{for(let e of t)if("childList"===e.type){[...document.querySelectorAll("button")].forEach((t=>{t.setAttribute("content",t.innerText)}))}})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),e="template-button",o=async()=>{const t=await window.roam42.common.getPageUidByTitle("roam/enhance/template-button"),e=await window.roam42.common.getBlockInfoByUID(t,!0);let o=null==e?void 0:e[0][0].children;window.roamEnhance.contextMenu.registerMenu.add(((e,n,i)=>{"roam/enhance/template-button"===i.pageTitle&&e.unshift({text:"zh-CN"===navigator.language?"刷新配置":"refresh configure",onClick:async()=>{const e=await window.roam42.common.getBlockInfoByUID(t,!0);o=null==e?void 0:e[0][0].children}})})),document.addEventListener("click",(async t=>{const e=t.target;if("BUTTON"!==e.tagName||"bp3-button bp3-small dont-focus-block"!==e.className)return;let n;try{n=window.yoyo.utils.getBlockUidFromId(e.closest(".rm-block__input").id)}catch(t){return console.log(t),void window.roam42.help.displayMessage("找不到 uid",2e3)}n&&(null==o||o.forEach((async t=>{var o;if(e.innerText.trim()===t.string.trim()){const e=(null===(o=t.children)||void 0===o?void 0:o[0].string).match(/^\`\`\`javascript\n([\s\S]*)\`\`\`$/);if(e){const t=Object.getPrototypeOf((async function(){})).constructor;try{await new t("$currentUid",e[1])(n)}catch(t){console.log(t),window.iziToast.info({position:"topCenter",title:"zh-CN"===navigator.language?"执行错误":"task error"})}}}})))}))},window.roamEnhance.loaded.add(e),t(o,e)}();
