!function(){"use strict";var t,n;new MutationObserver(((t,n)=>{for(let n of t)if("childList"===n.type){[...document.querySelectorAll("button")].forEach((t=>{t.setAttribute("content",t.innerText)}))}})).observe(document.body,{attributes:!1,childList:!0,subtree:!0}),t="template-button",n=async()=>{const t=await window.roam42.common.getPageUidByTitle("roam/enhance/template-button"),n=await window.roam42.common.getBlockInfoByUID(t,!0);let o=null==n?void 0:n[0][0].children;window.roamEnhance.contextMenu.registerMenu.add(((n,e,a)=>{"roam/enhance/template-button"===a.pageTitle&&n.unshift({text:"zh-CN"===navigator.language?"刷新配置":"refresh configure",onClick:async()=>{const n=await window.roam42.common.getBlockInfoByUID(t,!0);o=null==n?void 0:n[0][0].children}})})),document.addEventListener("click",(async t=>{const n=t.target;if("BUTTON"!==n.tagName||"bp3-button bp3-small dont-focus-block"!==n.className)return;let e;try{e=window.yoyo.utils.getBlockUidFromId(n.closest(".rm-block__input").id)}catch(t){return console.log(t),void window.roam42.help.displayMessage("找不到 uid",2e3)}e&&(null==o||o.forEach((async t=>{var o;if(n.innerText.trim()===t.string.trim()){const n=(null===(o=t.children)||void 0===o?void 0:o[0].string).match(/^\`\`\`javascript\n([\s\S]*)\`\`\`$/);if(n){const t=Object.getPrototypeOf((async function(){})).constructor;try{await new t("$currentUid",n[1])(e)}catch(t){console.log(t),window.iziToast.info({position:"topCenter",title:"zh-CN"===navigator.language?"执行错误":"task error"})}}}})))}))},window.roamEnhance.loaded.add(t),function(t,n=""){let o=0;!async function t(e){var a;try{await e()}catch(e){console.log("[name] error",e),o<5&&setTimeout((()=>t(++o)),2e3),o>5&&(null===(a=window.roam42)||void 0===a||a.help.displayMessage(`${n}加载失败`,2e3))}}(t)}((async()=>{await n({ctx:window.roamEnhance._plugins[t],name:t,options:window.roamEnhance._plugins[t].options||{}})}),t)}();
