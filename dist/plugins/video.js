!function(){"use strict";const o=(new Map).set(/https\:\/\/www\.bilibili\.com\/video\/([^\s]*)/,((o,t)=>`https://player.bilibili.com/player.html?bvid=${t}&page=1&high_quality=1&as_wide=1&allowfullscreen=true`)).set(/https\:\/\/www\.ixigua\.com\/([^\s]*)/,((o,t)=>`https://www.ixigua.com/iframe/${t}?autoplay=0&amp;startTime=0`)).set(/https\:\/\/v\.youku\.com\/v_show\/id_([^\s]*)\.html/,((o,t)=>`https://player.youku.com/embed/${t}`)).set(/https\:\/\/v\.qq\.com\/x\/page\/([^\s]*).html/,((o,t)=>`https://v.qq.com/txp/iframe/player.html?vid=${t}`));function t(t){const i=[...o.keys()].find((o=>o.test(t)));if(i){const e=t.match(i);return[o.get(i)(...e),i]}return[]}async function i(o){const t=o.closest("div.rm-block__input").id,i=window.roamEnhance.utils.getBlockUidFromId(t);return(await window.roam42.common.getBlockInfoByUID(i))[0][0]}window.roamEnhance.__resetVideoBlock=async function(o){const{string:t,uid:e}=await i(o);await window.roam42.common.updateBlock(e,t.replace(/\{\{videoo\:\s*(.*)\}\}/,((o,t)=>t)))},window.roamEnhance.__focusBlock=o=>{console.log(o.closest("div.rm-block__input")),window.roam42.common.simulateMouseClick(o.closest("div.rm-block__input"))},function(o,t=""){let i=0;function e(o){var n;try{o()}catch(o){console.log("error",o),i<5&&setTimeout((()=>e(++i)),3e3),i>5&&(null===(n=window.roam42)||void 0===n||n.help.displayMessage(`${t}加载失败`,2e3))}}setTimeout((()=>e(o)),3e3)}((()=>{document.arrive(".roam-app div.rm-block__input button",{existing:!0},(async function(o){if("videoo"===o.innerText){const{string:e}=await i(o),n=e.match(/\{\{videoo\:\s*(.*)\}\}/)[1],[a]=t(n);o.outerHTML=`<div class="rm-iframe__spacing-wrapper rm-video-player__spacing-wrapper"><div class="rm-iframe__container rm-video-player__container hoverparent"><div class="hoveronly"><button onclick="window.roamEnhance.__focusBlock(this)" class="bp3-button bp3-small bp3-icon-standard bp3-icon-edit bp3-minimal rm-iframe__edit-btn rm-video-player__edit-btn" content=""></button><button onclick="window.roamEnhance.__resetVideoBlock(this);" style="position: absolute; right: 25px; top: 0; z-index: 10;" class="bp3-button bp3-small bp3-icon-standard bp3-icon-reset bp3-minimal rm-iframe__edit-btn rm-video-player__edit-btn" content=""></button></div><iframe class="rm-video-player" style="width: 100%; height: 100%; pointer-events: auto;" src="${a}" frameborder="no" allowfullscreen="" sandbox="allow-top-navigation-by-user-activation allow-same-origin allow-forms allow-scripts allow-popups"></iframe></div></div>`}})),document.arrive(".roam-app div.rm-block__input a",{existing:!0},(async function(o){if(o.href){const[e,n]=t(o.href);if(n){const t=document.createElement("template");t.innerHTML='<span class="bp3-button bp3-minimal bp3-icon-video bp3-small dont-focus-block" tabindex="0"></span>',t.content.firstChild.onclick=async function(o){const t=o.target,{string:e,uid:a}=await i(t);t.parentNode.removeChild(t),window.roam42.common.updateBlock(a,e.replace(n,(o=>`{{videoo: ${o}}}`)))},o.before(t.content.firstChild)}}}))}),"video")}();
